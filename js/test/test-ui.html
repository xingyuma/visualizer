<style>
    .thumb {
        height: 75px;
        border: 1px solid #000;
        margin: 10px 5px 0 0;
    }
    </style>

<input type="file" id="files" name="files[]" multiple />
<output id="list"></output>

<script>
    function loaded(evt) {
        // Obtain the read file data
        console.log("dfasfs");
        console.log(evt.target.result);
        var fileString = evt.target.result;
        console.log(fileString);
        // Handle UTF-16 file dump
        if(utils.regexp.isChinese(fileString)) {
            //Chinese Characters + Name validation
        }
        else {
            // run other charset test
        }
        // xhr.send(fileString)     
    }
    
    function handleFileSelect(evt) {
        var files = evt.target.files; // FileList object
        
        // Loop through the FileList and render image files as thumbnails.
        for (var i = 0, f; f = files[i]; i++) {
            
            var reader = new FileReader();
            
            // Closure to capture the file information.
            reader.onload = (function(theFile) {
                             return function(e) {
                             console.log(e);
                             console.log(theFile);
                             // Render thumbnail.
//                             var span = document.createElement('span');
//                             span.innerHTML = ['<img class="thumb" src="', e.target.result,
//                                               '" title="', escape(theFile.name), '"/>'].join('');
//                             document.getElementById('list').insertBefore(span, null);
                             };
                             })(f);
            
            // Read in the image file as a data URL.
            console.log(f);
            reader.readAsText(f);
        }
    }
    
    document.getElementById('files').addEventListener('change', handleFileSelect, false);
    </script>